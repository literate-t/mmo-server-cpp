# MMORPG Game Server

## 목표

- 모던 C++로 제작하는 MMORPG 게임 서버
- 유니티 클라이언트와 연동
- 이동, 스킬 사용 동기화
- 인벤토리 사용

## 서버 코어

### 읽기 락/쓰기 락 구현

#### 읽기 락 정책
- 쓰기 락을 잡고 있지 않는 모든 스레드는 포괄적으로 읽기 락을 획득한다
- 쓰기 락을 잡은 동일 스레드만 읽기 락을 획득할 수 있다
- [쓰기 락 -> 읽기 락]은 허용된다

#### 쓰기 락 정책
- 쓰기 락은 동일 스레드에 한해서만 재귀적으로 락을 획득한다
- 쓰기 락을 획득되면 다른 스레드가 쓰기 락을 획득할 수 없다
- 락 플래그가 EMPTY 상태일 때만 쓰기 락을 획득할 수 있다
- [읽기 락 -> 쓰기 락]은 허용되지 않는다

### 데드락 탐지
- 락 요청 그래프와 락 소유 그래프를 통해 사이클을 탐지한다
  - 스레드 T1이 R1을 보유하고 R2을 요청한다
  - 스레드 T2이 R2을 보유하고 R1을 요청한다
  - R1 -> T1 -> R2 -> T2 -> R1 사이클 생성
- 락을 획득하기 전에 사이클 검사를 수행한다
- 동일 스레드 기준 재귀 획득이 가능하기 때문에 횟수를 카운트한다